---
title: "Publications"
date-modified: today
echo: false
warning: false
message: false
title-block-banner: false
page-layout: article
editor_options: 
  chunk_output_type: console
---

```{r}
#| include: false
library(tidyverse)
library(RefManageR)
library(lubridate)
library(gt)
library(gtExtras)
library(rbibutils)

pmobj <- local({
  q <- '(Luu, Michael[Author]) AND (Cedars-Sinai[Affiliation])'
  
  RefManageR::ReadPubMed(q, retmax = 999)
  
})

pmobj |> RefManageR::WriteBib(file = 'luu-publications-bib.bib')

rbibutils::bibConvert(infile = 'luu-publications-bib.bib', 
                      outfile = 'luu-publications-ris.ris')
  
pmtbl <- pmobj |> as_tibble()

```

Citations available to download as .bib and .ris

```{r}
#| column: screen-inset

tbl <- pmtbl %>%
  select(journal,
         title,
         author,
         year,
         month,
         doi) %>%
  mutate(author = str_split(author, ' and ')) %>%
  mutate(
    first_author = map_chr(author, ~ .x[[1]]),
    total_authors = map_int(author, ~ length(.x)),
    corresponding_author = map2_chr(author, total_authors, ~ .x[[.y]]),
    authorship_position = map_int(author, ~ str_which(.x, 'Michael Luu')),
    authorship_position = glue::glue('{authorship_position}/{total_authors}'),
    date = my(glue::glue('{month}-{year}'))
  ) %>%
  select(date,
         journal,
         title,
         first_author,
         corresponding_author,
         authorship_position,
         doi) %>%
  arrange(desc(date)) |>
  mutate(date = format(date, '%B-%Y')) |> 
  mutate(
    title = glue::glue('<a href=https://doi.org/{doi}>{title}</a>'),
    title = map(title, \(x) htmltools::HTML(x))
  ) |> 
  select(-doi)

tbl |>
  DT::datatable(
    style = 'bootstrap4',
    class = 'compact',
    colnames = c('Date', 'Journal', 'Title', 'First Author',
                 'Corresponding Author',
                 'Authorship Position'),
    filter = 'top'
  )
```
